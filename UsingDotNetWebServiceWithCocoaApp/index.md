---
layout: page
title: UsingDotNetWebServiceWithCocoaApp
---

I'm trying to connect to a web service using cocoa. I've used the General/WSMakeStub tool in the developer tools to generate the stubs, but the simple Hello World method which has no parameters does not accept a simple call. I'm just trying to call it using the line..
(General/NSString*)[Service1Service Helloworld] ; 

I've also tried using nil as a parameter like this...

    temp = (General/NSString*)[Service1Service Helloworld:nil] ;

This resulted in the following error...

*** -General/[NSPlaceholderDictionary initWithObjects:forKeys:count:]: attempt to insert nil value

I passed a string like this...
temp = (General/NSString*)[Service1Service General/HelloWorld:@"test"] ;

When I try the string I get the following error...

Invalid parameter not satisfying: aString != nil

I even tried a dummy dictionary. with a key of "test" and value of "mytest" That still generated the same message as the string attempt.

Any assistance is appreciated. I've included the wsdl and the implementation stub file for reference, below.

Paul

Here's the wsdl file generated by my sample .Net web service.

    
<?xml version="1.0" encoding="utf-8"?>
<definitions xmlns:http="http://schemas.xmlsoap.org/wsdl/http/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:s="http://www.w3.org/2001/General/XMLSchema" xmlns:s0="http://tempuri.org/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tm="http://microsoft.com/wsdl/mime/textMatching/" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/" targetNamespace="http://tempuri.org/" xmlns="http://schemas.xmlsoap.org/wsdl/">
<types>
<s:schema elementFormDefault="qualified" targetNamespace="http://tempuri.org/">
<s:element name="General/HelloWorld">
<s:complexType />
</s:element>
<s:element name="General/HelloWorldResponse">
<s:complexType>
<s:sequence>
<s:element minOccurs="0" maxOccurs="1" name="General/HelloWorldResult" type="s:string" />
</s:sequence>
</s:complexType>
</s:element>
</s:schema>
</types>
<message name="General/HelloWorldSoapIn">
<part name="parameters" element="s0:General/HelloWorld" />
</message>
<message name="General/HelloWorldSoapOut">
<part name="parameters" element="s0:General/HelloWorldResponse" />
</message>
<portType name="Service1Soap">
<operation name="General/HelloWorld">
<input message="s0:General/HelloWorldSoapIn" />
<output message="s0:General/HelloWorldSoapOut" />
</operation>
</portType>
<binding name="Service1Soap" type="s0:Service1Soap">
<soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="document" />
<operation name="General/HelloWorld">
<soap:operation soapAction="http://tempuri.org/General/HelloWorld" style="document" />
<input>
<soap:body use="literal" />
</input>
<output>
<soap:body use="literal" />
</output>
</operation>
</binding>
<service name="Service1">
<port name="Service1Soap" binding="s0:Service1Soap">
<soap:address location="http://localhost/General/MacTest/Service1.asmx" />
</port>
</service>
</definitions>

Here's the stub that the General/WSMakeStubs Developer tool created...
    
/*-
* Method Name: General/HelloWorld
* Documentation: <no documentation>
*/
@implementation General/HelloWorld
- (void) setParameters:(General/CFTypeRef /* Complex type http://tempuri.org/|General/HelloWorld */) in_parameters
{
id _paramValues[] = { 
in_parameters, 
}; 
General/NSString* _paramNames[] = { 
@"parameters", 
}; 
[super setParameters:1 values: _paramValues names: _paramNames]; 
}

- (id) resultValue
{
return General/super getResultDictionary] objectForKey: @"parameters"]; 
}

- ([[WSMethodInvocationRef) genCreateInvocationRef
{
return [self createInvocationRef 
/*endpoint*/: @"http://206.195.68.20/General/MacTest/Service1.asmx" 
methodName: @"General/HelloWorld" 
protocol: (General/NSString*) kWSSOAP2001Protocol 
style: (General/NSString*) kWSSOAPStyleRPC 
soapAction: @"http://tempuri.org/General/HelloWorld" 
methodNamespace: NULL /* No Method Namespace specified */ 
]; 
}

@end; /* General/HelloWorld */

@implementation Service1Service

+ (id) General/HelloWorld:(General/CFTypeRef /* Complex type http://tempuri.org/|General/HelloWorld */) in_parameters
{
id result = NULL; 
General/HelloWorld* _invocation = General/[[HelloWorld alloc] init]; 
[_invocation setParameters: in_parameters]; 
result = General/_invocation resultValue] retain]; 
[_invocation release]; 
return result; 
}

@end;

/*-
* End of WSDL document at http://206.195.68.20/[[MacTest/Service1.asmx?wsdl
*/ 



Paul,

Here is how I was able to invoke a .NET General/WebService:

General/NSDictionary *params = General/[[NSDictionary alloc] init];
General/HelloWorld* _invocation = General/[[HelloWorld alloc] init];    
[_invocation setParameters: params];    

General/NSDictionary *result = General/_invocation getResultDictionary] retain];    
if ([[WSMethodResultIsFault ((General/CFDictionaryRef) result)) /*error?*/
	[information setStringValue: [result objectForKey: (General/NSString *)kWSFaultString]];
else /*no error; all's well*/
	[information setStringValue: [result objectForKey: (General/NSString *)kWSMethodInvocationResult]];		
[_invocation release];    

Sean
